<!--
Meta Description: # حدث onstorage في جافا سكريبت: كل ما تحتاج معرفته ## ملخص يُعتبر حدث **onstorage** في جافا سكريبت أحد الأحداث الهامة التي تُستخدم لمراقبة التغييرات ف...
Meta Keywords: التخزين, المحلي, storage, حدث, يتم
-->

# حدث onstorage في جافا سكريبت: كل ما تحتاج معرفته

## ملخص
يُعتبر حدث **onstorage** في جافا سكريبت أحد الأحداث الهامة التي تُستخدم لمراقبة التغييرات في التخزين المحلي (Local Storage) عبر عدة نوافذ أو علامات تبويب في المتصفح. يُساعد هذا الحدث المطورين في معرفة متى تم تعديل البيانات في التخزين المحلي، مما يُسهل إدارة البيانات المشتركة بين تطبيقات الويب.

## الوثائق
### الغرض
يتم استخدام حدث **onstorage** للاستجابة للتغييرات التي تحدث في التخزين المحلي. عندما يتم تعديل التخزين المحلي من نافذة أو علامة تبويب أخرى، يتم إطلاق هذا الحدث في جميع النوافذ أو علامات التبويب التي تفتح نفس الأصل (Same Origin).

### الاستخدام
يتم استخدام **onstorage** عن طريق إضافة مستمع (Event Listener) للحدث على كائن `window`. يُمكنك الاستماع للتغييرات التي تحدث في التخزين المحلي عن طريق كتابة الكود التالي:

```javascript
window.addEventListener('storage', function(event) {
    console.log('تم تغيير التخزين المحلي:', event);
});
```

### التفاصيل
- **الحدث**: يُطلق حدث `storage` عندما يتم تغيير البيانات في التخزين المحلي.
- **الخصائص**: يحتوي كائن الحدث على عدة خصائص، مثل:
  - `key`: المفتاح الذي تم تغييره.
  - `newValue`: القيمة الجديدة للمفتاح.
  - `oldValue`: القيمة القديمة للمفتاح.
  - `url`: عنوان URL الخاص بالصفحة التي أجرت التغيير.
  - `storageArea`: يُشير إلى منطقة التخزين (Local Storage أو Session Storage).

## الأمثلة
### مثال 1: الاستماع لتغييرات التخزين المحلي

```javascript
window.addEventListener('storage', function(event) {
    console.log('تم تغيير المفتاح:', event.key);
    console.log('القيمة القديمة:', event.oldValue);
    console.log('القيمة الجديدة:', event.newValue);
});
```

### مثال 2: تحديث التخزين المحلي من نافذة أخرى

```javascript
// في نافذة أخرى، يمكنك تغيير التخزين المحلي:
localStorage.setItem('username', 'Ali');
```

عند تنفيذ الكود أعلاه في نافذة أو علامة تبويب أخرى، سيتم إطلاق حدث `storage` في جميع النوافذ الأخرى، وسيظهر التغيير في وحدة التحكم (Console).

## الشرح
### الأخطاء الشائعة
- **عدم استجابة النوافذ**: إذا كنت تعمل على نافذة واحدة فقط، فلن يتم إطلاق حدث `storage` عند تعديل التخزين المحلي. تأكد من فتح عدة نوافذ أو علامات تبويب.
- **تغييرات التخزين المحلي**: يجب أن يتم تعديل التخزين المحلي باستخدام `localStorage` أو `sessionStorage` في نفس الأصل.
- **الخصائص الفارغة**: عند إضافة مستمع للحدث، تأكد من التعامل مع السيناريوهات التي قد تحتوي فيها الخصائص على قيم فارغة.

## ملخص
يتيح لك حدث **onstorage** في جافا سكريبت مراقبة التغييرات في التخزين المحلي عبر نوافذ متعددة، مما يُساعد في إدارة البيانات بشكل أكثر فعالية.