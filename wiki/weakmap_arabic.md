<!--
Meta Description: # WeakMap في JavaScript: الفهم والاستخدام ## نظرة عامة WeakMap هو نوع من أنواع الهياكل البيانية في JavaScript، يُستخدم لتخزين الأزواج من المفاتيح والق...
Meta Keywords: weakmap, المفاتيح, يمكن, key, obj1
-->

# WeakMap في JavaScript: الفهم والاستخدام

## نظرة عامة
WeakMap هو نوع من أنواع الهياكل البيانية في JavaScript، يُستخدم لتخزين الأزواج من المفاتيح والقيم، حيث تكون المفاتيح من نوع الكائنات (objects) والقيم يمكن أن تكون أي نوع بيانات. يتميز WeakMap بأنه يسمح لج Garbage Collector بتحرير الذاكرة لكائنات المفاتيح المتحولة، مما يجعله مفيدًا في إدارة الذاكرة.

## الوثائق
### الغرض
تم تصميم WeakMap لتوفير طريقة فعالة لتخزين البيانات مع إمكانية الوصول إليها من خلال كائنات المفاتيح، دون الاحتفاظ بها في الذاكرة إذا لم يكن هناك أي مرجع آخر لها.

### الاستخدام
يتم إنشاء WeakMap باستخدام الباني `WeakMap()`. يمكن إضافة أزواج المفاتيح والقيم باستخدام الطريقة `set(key, value)`. للوصول إلى القيمة المرتبطة بمفتاح معين، يمكن استخدام `get(key)`. كما يمكن التحقق مما إذا كان المفتاح موجودًا باستخدام `has(key)`، وإزالة مفتاح وقيمة باستخدام `delete(key)`.

### التفاصيل
- **الخصائص**:
  - المفاتيح في WeakMap يجب أن تكون كائنات.
  - لا يمكن تكرار المفاتيح.
  - لا يتم الاحتفاظ بسجلات WeakMap في الذاكرة، مما يسمح بتحرير الذاكرة تلقائيًا.
  
- **طرق WeakMap**:
  - `set(key, value)`: يضيف زوجًا من المفتاح والقيمة.
  - `get(key)`: يستعيد القيمة المرتبطة بالمفتاح.
  - `has(key)`: يتحقق مما إذا كانت هناك قيمة مرتبطة بالمفتاح.
  - `delete(key)`: يزيل زوج المفتاح والقيمة.

## أمثلة
### مثال 1: إنشاء واستخدام WeakMap
```javascript
let weakMap = new WeakMap();
let obj1 = {};
let obj2 = {};

weakMap.set(obj1, 'قيمة مرتبطة مع obj1');
console.log(weakMap.get(obj1)); // 'قيمة مرتبطة مع obj1'
console.log(weakMap.has(obj2)); // false

weakMap.delete(obj1);
console.log(weakMap.get(obj1)); // undefined
```

### مثال 2: استخدام WeakMap لتخزين بيانات مؤقتة
```javascript
function createUser(name) {
    let user = {};
    weakMap.set(user, { name: name });
    return user;
}

let user1 = createUser('أحمد');
console.log(weakMap.get(user1)); // { name: 'أحمد' }
```

## الشرح
### الفخاخ والملاحظات
- **عدم إمكانية استخدام القيم كمفاتيح**: يجب أن تكون المفاتيح كائنات، لذا لا يمكن استخدام القيم الأولية مثل الأعداد أو السلاسل النصية.
- **عدم القدرة على التكرار**: WeakMap لا يدعم التكرار، مما يعني أنه لا يمكن استخدامه في الحلقات التقليدية مثل `for..of`.
- **التأثير على الأداء**: في بعض الأحيان، يمكن أن يؤدي استخدام WeakMap إلى تعقيد الكود، لذا يجب استخدامه عندما يكون ذلك ضروريًا فقط.

## ملخص
WeakMap هو هيكل بيانات فعال في JavaScript يُستخدم لتخزين أزواج المفاتيح والقيم حيث تُعتبر المفاتيح كائنات، ويتميز بإدارة الذاكرة بشكل تلقائي.